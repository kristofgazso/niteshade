<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>niteshade.simulation.Simulator &mdash; niteshade 0+unknown documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="niteshade.simulation.ArgNotFoundError" href="niteshade.simulation.ArgNotFoundError.html" />
    <link rel="prev" title="niteshade.simulation.wrap_results" href="niteshade.simulation.wrap_results.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> niteshade
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="niteshade.data.html">niteshade.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="niteshade.models.html">niteshade.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="niteshade.attack.html">niteshade.attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="niteshade.defence.html">niteshade.defence</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="niteshade.simulation.html">niteshade.simulation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="niteshade.simulation.wrap_results.html">niteshade.simulation.wrap_results</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">niteshade.simulation.Simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="niteshade.simulation.ArgNotFoundError.html">niteshade.simulation.ArgNotFoundError</a></li>
<li class="toctree-l3"><a class="reference internal" href="niteshade.simulation.ShapeMismatchError.html">niteshade.simulation.ShapeMismatchError</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="niteshade.postprocessing.html">niteshade.postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="niteshade.utils.html">niteshade.utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">niteshade</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API</a> &raquo;</li>
          <li><a href="niteshade.simulation.html">niteshade.simulation</a> &raquo;</li>
      <li>niteshade.simulation.Simulator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/niteshade.simulation.Simulator.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="niteshade-simulation-simulator">
<h1>niteshade.simulation.Simulator<a class="headerlink" href="#niteshade-simulation-simulator" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="niteshade.simulation.Simulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">niteshade.simulation.</span></span><span class="sig-name descname"><span class="pre">Simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attacker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defender</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#niteshade.simulation.Simulator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class used to simulate data poisoning attacks during online learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>-</em>) – stream of input data to train the model
with during supervised learning.</p></li>
<li><p><strong>y</strong> (<em>-</em>) – stream of target data (labels to the inputs)
to train the model with during supervised learning.</p></li>
<li><p><strong>model</strong> (<em>-</em>) – neural network model inheriting from torch.nn.Module to
be trained during online learning. Must present a .step()
method that performs a gradient descent step on a batch
of input and target data (X_batch and y_batch).</p></li>
<li><p><strong>attacker</strong> (<em>-</em>) – Attacker object that presents a .attack() method with an
implementation of a data poisoning attack strategy.</p></li>
<li><p><strong>defender</strong> (<em>-</em>) – Defender object that presents a .defend() method with an
implementation of a data poisoning defense strategy.</p></li>
<li><p><strong>batch_size</strong> (<em>-</em>) – batch size of model.</p></li>
<li><p><strong>num_episodes</strong> (<em>-</em>) – Number of ‘episodes’ that X and y span over. Here, we refer to
an episode as the time period over which a stream of incoming data
would be collected and subsequently passed on to the model to be
trained.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="niteshade.simulation.Simulator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attacker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defender</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_episodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#niteshade.simulation.Simulator.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#niteshade.simulation.Simulator.__init__" title="niteshade.simulation.Simulator.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(X, y, model[, attacker, defender, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#niteshade.simulation.Simulator.run" title="niteshade.simulation.Simulator.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>([defender_args, attacker_args, ...])</p></td>
<td><p>Runs a simulation of an online learning setting where, if specified, an attacker will 'poison' (i.e.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="niteshade.simulation.Simulator.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">defender_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attacker_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attacker_requires_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defender_requires_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#niteshade.simulation.Simulator.run" title="Permalink to this definition"></a></dt>
<dd><p>Runs a simulation of an online learning setting where, if specified, an attacker
will ‘poison’ (i.e. perturb) incoming data points (from an episode) according to an
implemented attack strategy (i.e. .attack() method) and a defender (also, if
specified,) will reject points deemed perturbed by its defence strategy (i.e.
.defend() method).</p>
<p>NOTE:
If the attacker/defender require a model for their attack/defense strategies,
the user should only set attacker_requires_model=True/defender_requires_model=True.
The .attack()/.defend() method should then contain the argument ‘model’;
this argument will be added as a key to attacker_args/defender_args and updated with
the new model after each gradient descent step as online learning progresses.</p>
<p><strong>Metadata</strong>:</p>
<p>As the simulation progresses; each episodes’ original, post-attack,
and post-defense inputs and labels will be saved in self.results
(a dictionary) in a list under the keys ‘original’, ‘post-attack’,
and ‘post-defense’, respectively. All the datapoints in an episode
are saved as values in a dictionary where the keys are labels indicating
if a point is unperturbed (in which case the label is simply the index
of the point in the inputted X and y), poisoned (labelled as ‘p_n’
where n is an integer indicating that it is the nth poisoned point),
or modified by the defender (labelled as ‘d_n’ where n is an integer
indicating that it is the nth defended point). If the defender rejects
a point in episode i, it can be inferred by inspecting the points missing
from self.results[‘post_defense’][i] with respect to self.results[‘post_attack’][i].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>defender_args</strong> (<em>dict</em>) – dictionary containing extra arguments (other than the episode inputs
X and labels y) for defender .defend() method.</p></li>
<li><p><strong>attacker_args</strong> (<em>dict</em>) – dictionary containing extra arguments (other than the episode inputs
X and labels y) for attacker .attack() method.</p></li>
<li><p><strong>attacker_requires_model</strong> (<em>bool</em>) – specifies if the .attack() method of the attacker requires
the updated model at each episode.</p></li>
<li><p><strong>defender_requires_model</strong> (<em>bool</em>) – specifies if the .defend() method of the defender requires
the updated model at each episode.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Specifies if loss should be printed for each batch the model is trained on.
Default = True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="niteshade.simulation.wrap_results.html" class="btn btn-neutral float-left" title="niteshade.simulation.wrap_results" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="niteshade.simulation.ArgNotFoundError.html" class="btn btn-neutral float-right" title="niteshade.simulation.ArgNotFoundError" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Mart Bakler, Oskar Fernlund, Alex Ntemourtsidou, Jaime Sabal, Mustafa Saleem.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>